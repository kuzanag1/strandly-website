<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile UX Deployment Verification - Strandly</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .verification-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        
        .check-item {
            margin: 15px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .check-passed {
            background: rgba(40, 167, 69, 0.3);
        }
        
        .check-failed {
            background: rgba(220, 53, 69, 0.3);
        }
        
        .status {
            font-weight: bold;
            font-size: 18px;
        }
        
        .test-controls {
            margin: 30px 0;
            text-align: center;
        }
        
        .test-button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 5px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .mobile-preview {
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }
        
        .screen-sizes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .screen-size {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .verification-container {
                padding: 20px 15px;
            }
            
            .screen-sizes {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="verification-container">
        <h1>üöÄ Mobile UX Deployment Verification</h1>
        <p>Testing mobile optimization deployment status...</p>
        
        <div id="verification-results">
            <!-- Results will be populated by JavaScript -->
        </div>
        
        <div class="test-controls">
            <button class="test-button" onclick="runAllTests()">üîÑ Run All Tests</button>
            <button class="test-button" onclick="testEmailCapture()">üìß Test Email Capture</button>
            <button class="test-button" onclick="testProgressTracking()">üìä Test Progress Tracking</button>
            <button class="test-button" onclick="testTouchOptimization()">üëÜ Test Touch Features</button>
        </div>
        
        <div class="mobile-preview">
            <h3>üì± Current Screen Information</h3>
            <div id="screen-info">
                <p>Width: <span id="screen-width"></span>px</p>
                <p>Height: <span id="screen-height"></span>px</p>
                <p>Device Pixel Ratio: <span id="device-ratio"></span></p>
                <p>Touch Support: <span id="touch-support"></span></p>
                <p>User Agent: <span id="user-agent"></span></p>
            </div>
        </div>
        
        <div class="screen-sizes">
            <div class="screen-size">
                <h4>iPhone SE (375px)</h4>
                <p id="iphone-se-status">Testing...</p>
            </div>
            <div class="screen-size">
                <h4>Standard Mobile (414px)</h4>
                <p id="standard-mobile-status">Testing...</p>
            </div>
            <div class="screen-size">
                <h4>Tablet (768px)</h4>
                <p id="tablet-status">Testing...</p>
            </div>
        </div>
        
        <div id="performance-metrics">
            <h3>‚ö° Performance Metrics</h3>
            <div id="metrics-content">
                <!-- Performance data will be shown here -->
            </div>
        </div>
    </div>
    
    <script>
        // Verification Test Suite
        let testResults = {};
        
        function runAllTests() {
            console.log('üöÄ Starting Mobile UX Deployment Verification...');
            
            // Clear previous results
            testResults = {};
            
            // Run all verification tests
            testFilePresence();
            testMobileOptimizer();
            testCSSIntegration();
            testJavaScriptIntegration();
            testAccessibilityFeatures();
            testPerformanceMetrics();
            testResponsiveBreakpoints();
            
            // Display results
            displayResults();
            updateScreenInfo();
        }
        
        function testFilePresence() {
            const files = [
                'js/ux-director-mobile-optimization.js',
                'js/mobile-integration-bridge.js',
                'css/ux-director-mobile-enhancements.css',
                'css/mobile-optimization.css',
                'css/mobile-emergency-fix.css'
            ];
            
            files.forEach(file => {
                fetch(file)
                    .then(response => {
                        testResults[`file_${file.replace(/[^a-zA-Z0-9]/g, '_')}`] = {
                            name: `File: ${file}`,
                            status: response.ok ? 'PASSED' : 'FAILED',
                            message: response.ok ? 'File accessible' : `HTTP ${response.status}`
                        };
                        displayResults();
                    })
                    .catch(error => {
                        testResults[`file_${file.replace(/[^a-zA-Z0-9]/g, '_')}`] = {
                            name: `File: ${file}`,
                            status: 'FAILED',
                            message: 'File not accessible'
                        };
                        displayResults();
                    });
            });
        }
        
        function testMobileOptimizer() {
            const hasOptimizer = typeof window.mobileUXOptimizer !== 'undefined';
            
            testResults.mobile_optimizer = {
                name: 'Mobile UX Optimizer',
                status: hasOptimizer ? 'PASSED' : 'FAILED',
                message: hasOptimizer ? 'Successfully loaded' : 'Not found in window object'
            };
            
            if (hasOptimizer) {
                // Test optimizer methods
                const methods = [
                    'onQuestionChange',
                    'onOptionSelected',
                    'onQuizCompleted',
                    'onPaymentInitiated',
                    'getPerformanceMetrics'
                ];
                
                methods.forEach(method => {
                    const hasMethod = typeof window.mobileUXOptimizer[method] === 'function';
                    testResults[`optimizer_${method}`] = {
                        name: `Method: ${method}`,
                        status: hasMethod ? 'PASSED' : 'FAILED',
                        message: hasMethod ? 'Available' : 'Missing method'
                    };
                });
            }
        }
        
        function testCSSIntegration() {
            const testClasses = [
                'value-stack-mobile',
                'email-overlay-mobile',
                'milestone-celebration',
                'error-recovery-mobile'
            ];
            
            testClasses.forEach(className => {
                const hasStyle = hasCSS(className);
                testResults[`css_${className}`] = {
                    name: `CSS Class: ${className}`,
                    status: hasStyle ? 'PASSED' : 'FAILED',
                    message: hasStyle ? 'Style rules found' : 'No matching styles'
                };
            });
        }
        
        function hasCSS(className) {
            const sheets = document.styleSheets;
            for (let i = 0; i < sheets.length; i++) {
                try {
                    const rules = sheets[i].cssRules || sheets[i].rules;
                    for (let j = 0; j < rules.length; j++) {
                        if (rules[j].selectorText && rules[j].selectorText.includes(className)) {
                            return true;
                        }
                    }
                } catch (e) {
                    // Cross-origin stylesheets may throw errors
                    continue;
                }
            }
            return false;
        }
        
        function testJavaScriptIntegration() {
            const hasBridge = typeof window.mobileBridge !== 'undefined';
            
            testResults.integration_bridge = {
                name: 'Mobile Integration Bridge',
                status: hasBridge ? 'PASSED' : 'FAILED',
                message: hasBridge ? 'Bridge loaded successfully' : 'Integration bridge not found'
            };
            
            if (hasBridge) {
                const bridgeMethods = ['updateProgress', 'triggerCompletion', 'trackOptionSelection'];
                bridgeMethods.forEach(method => {
                    const hasMethod = typeof window.mobileBridge[method] === 'function';
                    testResults[`bridge_${method}`] = {
                        name: `Bridge Method: ${method}`,
                        status: hasMethod ? 'PASSED' : 'FAILED',
                        message: hasMethod ? 'Available' : 'Missing method'
                    };
                });
            }
        }
        
        function testAccessibilityFeatures() {
            // Test for ARIA attributes
            const hasAriaSupport = document.querySelector('[role]') !== null;
            testResults.aria_support = {
                name: 'ARIA Support',
                status: hasAriaSupport ? 'PASSED' : 'NEEDS_IMPROVEMENT',
                message: hasAriaSupport ? 'ARIA attributes found' : 'Consider adding more ARIA labels'
            };
            
            // Test for keyboard navigation
            const hasFocusable = document.querySelector('[tabindex]') !== null;
            testResults.keyboard_nav = {
                name: 'Keyboard Navigation',
                status: hasFocusable ? 'PASSED' : 'NEEDS_IMPROVEMENT',
                message: hasFocusable ? 'Focusable elements found' : 'Add tabindex attributes'
            };
        }
        
        function testPerformanceMetrics() {
            const startTime = performance.now();
            
            // Simulate performance test
            setTimeout(() => {
                const endTime = performance.now();
                const loadTime = endTime - startTime;
                
                testResults.performance = {
                    name: 'Page Performance',
                    status: loadTime < 100 ? 'PASSED' : 'WARNING',
                    message: `Load time: ${loadTime.toFixed(2)}ms`
                };
                
                displayResults();
            }, 50);
        }
        
        function testResponsiveBreakpoints() {
            const breakpoints = [
                { name: 'Mobile (‚â§480px)', width: 480 },
                { name: 'Tablet (‚â§768px)', width: 768 },
                { name: 'Desktop (>768px)', width: 1024 }
            ];
            
            breakpoints.forEach(bp => {
                const mediaQuery = window.matchMedia(`(max-width: ${bp.width}px)`);
                const status = window.innerWidth <= bp.width ? mediaQuery.matches : !mediaQuery.matches;
                
                testResults[`breakpoint_${bp.width}`] = {
                    name: bp.name,
                    status: status ? 'PASSED' : 'WARNING',
                    message: `Current: ${window.innerWidth}px`
                };
            });
        }
        
        function testEmailCapture() {
            if (window.mobileUXOptimizer && typeof window.mobileUXOptimizer.triggerEmailCapture === 'function') {
                window.mobileUXOptimizer.triggerEmailCapture();
                testResults.email_capture_test = {
                    name: 'Email Capture Test',
                    status: 'PASSED',
                    message: 'Email capture triggered successfully'
                };
            } else {
                testResults.email_capture_test = {
                    name: 'Email Capture Test',
                    status: 'FAILED',
                    message: 'Email capture method not available'
                };
            }
            displayResults();
        }
        
        function testProgressTracking() {
            if (window.mobileUXOptimizer) {
                window.mobileUXOptimizer.onQuestionChange(7, 10); // 70% progress
                testResults.progress_tracking_test = {
                    name: 'Progress Tracking Test',
                    status: 'PASSED',
                    message: 'Progress updated to 70%'
                };
            } else {
                testResults.progress_tracking_test = {
                    name: 'Progress Tracking Test',
                    status: 'FAILED',
                    message: 'Mobile optimizer not available'
                };
            }
            displayResults();
        }
        
        function testTouchOptimization() {
            const touchSupported = 'ontouchstart' in window;
            const hasTouch = document.body.classList.contains('touch-device');
            
            testResults.touch_optimization = {
                name: 'Touch Optimization',
                status: touchSupported ? 'PASSED' : 'WARNING',
                message: `Touch events: ${touchSupported ? 'Supported' : 'Not detected'}`
            };
            
            testResults.touch_classes = {
                name: 'Touch CSS Classes',
                status: hasTouch ? 'PASSED' : 'WARNING',
                message: hasTouch ? 'Touch classes applied' : 'Touch classes not applied'
            };
            
            displayResults();
        }
        
        function displayResults() {
            const container = document.getElementById('verification-results');
            let html = '<h2>üìä Test Results</h2>';
            
            let passed = 0;
            let failed = 0;
            let warnings = 0;
            
            Object.values(testResults).forEach(test => {
                const statusClass = test.status === 'PASSED' ? 'check-passed' : 
                                   test.status === 'FAILED' ? 'check-failed' : 'check-warning';
                
                const statusIcon = test.status === 'PASSED' ? '‚úÖ' : 
                                   test.status === 'FAILED' ? '‚ùå' : '‚ö†Ô∏è';
                
                html += `
                    <div class="check-item ${statusClass}">
                        <div>
                            <strong>${test.name}</strong><br>
                            <small>${test.message}</small>
                        </div>
                        <div class="status">${statusIcon} ${test.status}</div>
                    </div>
                `;
                
                if (test.status === 'PASSED') passed++;
                else if (test.status === 'FAILED') failed++;
                else warnings++;
            });
            
            // Add summary
            html = `
                <div class="check-item">
                    <div>
                        <strong>üìà Summary</strong><br>
                        <small>Passed: ${passed} | Failed: ${failed} | Warnings: ${warnings}</small>
                    </div>
                    <div class="status">${failed === 0 ? '‚úÖ' : '‚ùå'} ${failed === 0 ? 'ALL TESTS PASSED' : 'ISSUES FOUND'}</div>
                </div>
            ` + html;
            
            container.innerHTML = html;
        }
        
        function updateScreenInfo() {
            document.getElementById('screen-width').textContent = window.innerWidth;
            document.getElementById('screen-height').textContent = window.innerHeight;
            document.getElementById('device-ratio').textContent = window.devicePixelRatio || 1;
            document.getElementById('touch-support').textContent = 'ontouchstart' in window ? 'Yes' : 'No';
            document.getElementById('user-agent').textContent = navigator.userAgent.substring(0, 100) + '...';
            
            // Update screen size statuses
            document.getElementById('iphone-se-status').textContent = 
                window.innerWidth <= 375 ? '‚úÖ Active' : '‚è∏Ô∏è Inactive';
            document.getElementById('standard-mobile-status').textContent = 
                window.innerWidth <= 414 && window.innerWidth > 375 ? '‚úÖ Active' : '‚è∏Ô∏è Inactive';
            document.getElementById('tablet-status').textContent = 
                window.innerWidth <= 768 && window.innerWidth > 414 ? '‚úÖ Active' : '‚è∏Ô∏è Inactive';
        }
        
        // Performance monitoring
        function updatePerformanceMetrics() {
            if (window.mobileUXOptimizer && typeof window.mobileUXOptimizer.getPerformanceMetrics === 'function') {
                const metrics = window.mobileUXOptimizer.getPerformanceMetrics();
                document.getElementById('metrics-content').innerHTML = `
                    <p>Load Time: ${metrics.loadTime || 'N/A'}ms</p>
                    <p>LCP: ${metrics.lcp || 'N/A'}ms</p>
                    <p>FID: ${metrics.fid || 'N/A'}ms</p>
                    <p>CLS: ${metrics.cls || 'N/A'}</p>
                    <p>Interactions: ${metrics.interactions ? metrics.interactions.length : 0}</p>
                    <p>Errors: ${metrics.errors ? metrics.errors.length : 0}</p>
                `;
            } else {
                document.getElementById('metrics-content').innerHTML = '<p>Mobile optimizer not available for metrics</p>';
            }
        }
        
        // Auto-run tests on load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(runAllTests, 500);
            setInterval(updatePerformanceMetrics, 2000);
        });
        
        // Update screen info on resize
        window.addEventListener('resize', updateScreenInfo);
        
    </script>
</body>
</html>